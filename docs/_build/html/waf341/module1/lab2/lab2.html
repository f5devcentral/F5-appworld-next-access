<!DOCTYPE html>
<head>
  
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-PPZPQ6');</script>
  <!-- End Google Tag Manager -->
    <title>Lab 1.2: Credential Stuffing</title>
  

  <meta charset="utf-8">
  <!-- Twitter Bootstrap viewport setting -->
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!-- F5 metadata -->
  <meta name="title" content="Lab 1.2: Credential Stuffing"/>
  <meta name="product" content="F5 Web Application Firewall Solutions"/>
  <meta name="version" content=""/>
  <meta name="updated_date"  content="2023-05-04 07:11:03"/>
  <meta name="archived" content="Archived documents excluded"/>
  <meta name="doc_type" content="Manual"/>
  <meta name="lifecycle" content="release"/>
  <meta name="F5 Web Application Firewall Solutions" content=""/>


  

  
  <link href="https://cdn.f5.com/favicon.ico" rel="icon">

</head>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Lab 1.2: Credential Stuffing &#8212; F5 Web Application Firewall Solutions  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" href="../../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/f5.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/f5-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/CoveoFullSearch.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/custom.css" type="text/css" />
    <link rel="stylesheet" href="https://use.fontawesome.com/21fb8a09c3.css" type="text/css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Module 2: HTTP Methods, DataGuard, Sensitive Data" href="../../module2/module2.html" />
    <link rel="prev" title="Lab 1.1: Brute Force Attack Prevention" href="../lab1/lab1.html" /> 
  </head><body>
  <div id="clouddocs-header"></div>

    <div id="sidebar" class="section-nav">
      
      <!--  version selector ------------------>
      <div id="version_selector_wrapper">
      </div>
      <nav class="nav-sidebartoc">

        
         <h5>F5 Web Application Firewall Solutions  </h5>
        

        <hr>
        <span class="nav-sidebartoc">
            <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../waf102/waf102.html">WAF 102 - Getting started with WAF, Bot Detection and Threat Campaigns</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../waf111/waf111.html">WAF 111 - Protecting Yourself Against the OWASP Top 10</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../waf201/waf201.html">WAF 201 – Elevated WAF Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../waf2023/waf2023.html">WAF 101 - BIG-IP Security:  Mitigating App Vulnerabilities with AWAF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../waf301/waf301.html">WAF 301 - AWAF in a CI/CD Pipeline (Self Guided)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../waf302/waf302.html">WAF 302 - Enabling API Protection with APM and AWAF</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../waf341.html">WAF 341 – Advanced Protection and Positive Security (Self Guided)</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../labinfo/labinfo.html">Lab Environment &amp; TopologyLab Environment &amp; Topology</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../module1.html">Module 1: Bruteforce Protection, Credential Stuffing</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../lab1/lab1.html">Lab 1.1: Brute Force Attack Prevention</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Lab 1.2: Credential Stuffing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../module2/module2.html">Module 2: HTTP Methods, DataGuard, Sensitive Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../module3/module3.html">Module 3: DataSafe, Parameter Protection</a></li>
</ul>
</li>
</ul>

        </span><!-- Use this file to add extra links to the bottom of the ToC sidebar -->
<hr>
  <span class="nav-sidebartoc">
 <!-- insert content here -->
  </span>
      </nav>
    </div>


    <div id="right-sidebar">
      <h7 style="font-weight:normal">On this page:</h7>
      <nav class="nav-sidebartoc">
        <span class="nav-sidebartoc">
            <ul>
<li><a class="reference internal" href="#">Lab 1.2: Credential Stuffing</a><ul>
<li><a class="reference internal" href="#task-1-configure-credential-stuffing-detection">Task 1 - Configure Credential Stuffing Detection</a></li>
<li><a class="reference internal" href="#task-2-test-credential-stuffing-detection">Task 2 - Test Credential Stuffing Detection</a></li>
</ul>
</li>
</ul>

         </span>
      </nav>
    </div>





  
  <div class="main active" id="content" >
    <article class="docs-container site-article-inner">
              <!-- custom breadcrumb -->
        <h5>
            <a href="../../../index.html">F5 Web Application Firewall Solutions</a>
              &gt; <a href="../../waf341.html">WAF 341 – Advanced Protection and Positive Security (Self Guided)</a>
              &gt; <a href="../module1.html">Module 1: Bruteforce Protection, Credential Stuffing</a>

          <span class="right">
             <a href="../../../_sources/waf341/module1/lab2/lab2.rst.txt" rel="nofollow">Source</a> |
             <a href="https://github.com/f5devcentral/f5-agility-labs-waf">Edit on <i class="fa fa-github" aria-hidden="true"></i></a>
          </span>
        </h5>
        <!-- end custom breadcrumb -->
      


    <!--a title="Export PDF" id="export-pdf" class="btn btn btn-link pull-right">View PDF</a-->
    <button type="button" id="export-pdf" class="btn btn-link right">PDF</button>


    
     
         <div class="sidebar" id="version-warning" style="display: none;">
           <p class="first sidebar-title">
           <span class="icon fa fa-info-circle fa-lg"></span> Version notice:</p>
           <p class="last" id="currentVersion"></p>
          </div>


     <div role="main">
        
  <div class="section" id="lab-1-2-credential-stuffing">
<h1>Lab 1.2: Credential Stuffing<a class="headerlink" href="#lab-1-2-credential-stuffing" title="Permalink to this heading">¶</a></h1>
<p>Credential stuffing is a type of brute force attack that leverages stolen
credentials from another source. This source is most commonly the breach of a
widely used online service.  These leaked credentials are then levered in an
attempt to compromise higher value targets in instances where users used the
same credentials across multiple services. BIG-IP now has the capability to
detect these types of attacks by employing a database of credentials that are
known to have been compromised in a previous breach. The credentials are stored
as one-way hashed usernames and passwords to protect them from further
disclosure. In a production environment, Client Side Integrity Defense (or
both), may be a more effective form of mitigation during an actual attack. Feel
free to experiment with this in the lab.</p>
<div class="section" id="task-1-configure-credential-stuffing-detection">
<h2>Task 1 - Configure Credential Stuffing Detection<a class="headerlink" href="#task-1-configure-credential-stuffing-detection" title="Permalink to this heading">¶</a></h2>
<ol class="arabic">
<li><p class="first">Open the BIG-IP GUI interface.</p>
</li>
<li><p class="first">Navigate to <strong>Security -&gt; Application Security -&gt; Brute Force Attack
Prevention</strong>.</p>
</li>
<li><p class="first">Click on the /rest/user/login configuration created earlier.</p>
</li>
<li><p class="first">Configure <strong>Credential Stuffing</strong> detection within the <strong>Distributed Brute
Force Protection</strong> Section as follows:</p>
<a class="reference internal image-reference" href="../../../_images/dist_brute_force_protection.PNG"><img alt="../../../_images/dist_brute_force_protection.PNG" src="../../../_images/dist_brute_force_protection.PNG" style="width: 600px;" /></a>
</li>
<li><p class="first">Click <strong>Save</strong>.</p>
</li>
<li><p class="first">Click <strong>Apply Policy</strong>.</p>
</li>
</ol>
</div>
<div class="section" id="task-2-test-credential-stuffing-detection">
<h2>Task 2 - Test Credential Stuffing Detection<a class="headerlink" href="#task-2-test-credential-stuffing-detection" title="Permalink to this heading">¶</a></h2>
<ol class="arabic">
<li><p class="first">Open a new Private Browsing window in <strong>Chrome or Firefox</strong>.</p>
</li>
<li><p class="first">Go to the to Juice Shop login page at
<code class="docutils literal notranslate"><span class="pre">https://juiceshop.f5agility.com/#/login</span></code></p>
</li>
<li><p class="first">Attempt to login using the username <code class="docutils literal notranslate"><span class="pre">demo33&#64;fidnet.com</span></code> and password
<code class="docutils literal notranslate"><span class="pre">mountainman01</span></code></p>
</li>
<li><p class="first">Examine the most recent requests in the event log by navigating to Security
-&gt; Event Logs -&gt; Applications -&gt; Requests</p>
<a class="reference internal image-reference" href="../../../_images/brute_force_events.PNG"><img alt="../../../_images/brute_force_events.PNG" src="../../../_images/brute_force_events.PNG" style="width: 600px;" /></a>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Take note of the username field. The request was matched as a
potential credential stuffing attack.</p>
</div>
</li>
<li><p class="first">Near the <strong>Brute force: Maximum Login Attempts are exceeded</strong> header at the
top of the event window click on the number under <strong>Occurrences</strong>:</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The message indicates the number of login attempts that matched
the internal database.</p>
</div>
</li>
<li><p class="first">Now check out the reporting under <strong>Event Logs -&gt; Application -&gt; Brute Force
Attacks</strong>:</p>
<a class="reference internal image-reference" href="../../../_images/brute_force_enent_log.PNG"><img alt="../../../_images/brute_force_enent_log.PNG" src="../../../_images/brute_force_enent_log.PNG" style="width: 600px;" /></a>
</li>
<li><p class="first">Click on one of the attack entries to get some more detail about the attack:</p>
</li>
<li><p class="first">For fun, head over to <code class="docutils literal notranslate"><span class="pre">https://haveibeenpwned.com/</span></code> and put in the email
address of the account we used in the lab to get some details. It may also
be interesting to put in your own account(s) to see if any of your
credentials have been breached. You could also try some of your old
username/password combinations against the credential stuffing database on
the F5. While on the main page explore some of the breach data on the bottom
to get a sense of how big this problem is.</p>
</li>
<li><p class="first">In order to release any blocking that’s currently in place, navigate to
<strong>Security -&gt; Application Security -&gt; Brute Force Attack Prevention</strong> and
<strong>Delete</strong> the Brute Force configuration we created previously.</p>
</li>
<li><p class="first">Click <strong>Apply Policy</strong>.</p>
</li>
<li><p class="first">Navigate to <strong>Local Traffic &gt; Virtual Servers &gt; Virtual Server List &gt;
owasp_juice_shop_443_vs &gt; Security &gt; Policies</strong> and ensure that the
juice_shop_waf policy and the Log All requests log profile are enabled on
the owasp_juice_shop_443_vs virtual server as shown below removing the Bot
Profile.</p>
<a class="reference internal image-reference" href="../../../_images/vs_config.PNG"><img alt="../../../_images/vs_config.PNG" src="../../../_images/vs_config.PNG" style="width: 600px;" /></a>
</li>
</ol>
<p><strong>This concludes Lab 1.2</strong></p>
</div>
</div>


     </div>
    
     <div class="row next-prev-btn-row">
       <div class="col-lg-12">
       
        <a href="../lab1/lab1.html" title="Lab 1.1: Brute Force Attack Prevention" accesskey="p" class="btn btn-primary left"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous</a>
       
       
          <a href="../../module2/module2.html" title="Module 2: HTTP Methods, DataGuard, Sensitive Data" accesskey="n" class="btn btn-primary right">Next <i class="fa fa-arrow-circle-right" aria-hidden="true"></i></a>
       
     </div>
     </div>
    

    </article>
  </div>

</div>


  <div id="clouddocs-footer"></div>
  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->

  <script src="../../../_static/js/index.js"></script>
  <script src="../../../_static/js/jquery.appear.js"></script>
  <script src="../../../_static/js/printThis.js"></script>
  <script src="../../../_static/js/bootstrap.min.js"></script>
  <script src="../../../_static/js/clouddocs.js"></script>
  <script src="../../../_static/js/CoveoJsSearch.Lazy.min.js"></script>
  </body>
</html>