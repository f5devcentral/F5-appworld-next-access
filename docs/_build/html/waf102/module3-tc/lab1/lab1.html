<!DOCTYPE html>
<head>
  
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-PPZPQ6');</script>
  <!-- End Google Tag Manager -->
    <title>Exercise 3.1: Threat Campaigns</title>
  

  <meta charset="utf-8">
  <!-- Twitter Bootstrap viewport setting -->
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!-- F5 metadata -->
  <meta name="title" content="Exercise 3.1: Threat Campaigns"/>
  <meta name="product" content="F5 Web Application Firewall Solutions"/>
  <meta name="version" content=""/>
  <meta name="updated_date"  content="2023-05-04 07:11:03"/>
  <meta name="archived" content="Archived documents excluded"/>
  <meta name="doc_type" content="Manual"/>
  <meta name="lifecycle" content="release"/>
  <meta name="F5 Web Application Firewall Solutions" content=""/>


  

  
  <link href="https://cdn.f5.com/favicon.ico" rel="icon">

</head>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Exercise 3.1: Threat Campaigns &#8212; F5 Web Application Firewall Solutions  documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css" />
    <link rel="stylesheet" href="../../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/f5.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/f5-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/CoveoFullSearch.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/css/custom.css" type="text/css" />
    <link rel="stylesheet" href="https://use.fontawesome.com/21fb8a09c3.css" type="text/css" />
    <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/sphinx_highlight.js"></script>
    <script src="../../../_static/clipboard.min.js"></script>
    <script src="../../../_static/copybutton.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Module 4: Transparent WAF Policy" href="../../module4-xparent-policy/module4.html" />
    <link rel="prev" title="Module 3: Threat Campaigns" href="../module3.html" /> 
  </head><body>
  <div id="clouddocs-header"></div>

    <div id="sidebar" class="section-nav">
      
      <!--  version selector ------------------>
      <div id="version_selector_wrapper">
      </div>
      <nav class="nav-sidebartoc">

        
         <h5>F5 Web Application Firewall Solutions  </h5>
        

        <hr>
        <span class="nav-sidebartoc">
            <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../waf102.html">WAF 102 - Getting started with WAF, Bot Detection and Threat Campaigns</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../labinfo/labinfo.html">Lab Environment &amp; Topology</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../module1-ipi-and-geo/module1.html">Module 1: IPI &amp; Geolocation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../module2-bot/module2.html">Module 2: Bot Detection</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../module3.html">Module 3: Threat Campaigns</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Exercise 3.1: Threat Campaigns</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../module4-xparent-policy/module4.html">Module 4: Transparent WAF Policy</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../waf111/waf111.html">WAF 111 - Protecting Yourself Against the OWASP Top 10</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../waf201/waf201.html">WAF 201 – Elevated WAF Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../waf2023/waf2023.html">WAF 101 - BIG-IP Security:  Mitigating App Vulnerabilities with AWAF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../waf301/waf301.html">WAF 301 - AWAF in a CI/CD Pipeline (Self Guided)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../waf302/waf302.html">WAF 302 - Enabling API Protection with APM and AWAF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../waf341/waf341.html">WAF 341 – Advanced Protection and Positive Security (Self Guided)</a></li>
</ul>

        </span><!-- Use this file to add extra links to the bottom of the ToC sidebar -->
<hr>
  <span class="nav-sidebartoc">
 <!-- insert content here -->
  </span>
      </nav>
    </div>


    <div id="right-sidebar">
      <h7 style="font-weight:normal">On this page:</h7>
      <nav class="nav-sidebartoc">
        <span class="nav-sidebartoc">
            <ul>
<li><a class="reference internal" href="#">Exercise 3.1: Threat Campaigns</a><ul>
<li><a class="reference internal" href="#objective">Objective</a></li>
<li><a class="reference internal" href="#prep-the-virtual-server">Prep the Virtual Server</a></li>
<li><a class="reference internal" href="#review-tc-signatures">Review TC Signatures</a></li>
<li><a class="reference internal" href="#review-tc-learning-and-blocking-settings">Review TC Learning and Blocking Settings</a></li>
<li><a class="reference internal" href="#test-tc-signatures-and-review-logs">Test TC Signatures and Review Logs</a></li>
</ul>
</li>
</ul>

         </span>
      </nav>
    </div>





  
  <div class="main active" id="content" >
    <article class="docs-container site-article-inner">
              <!-- custom breadcrumb -->
        <h5>
            <a href="../../../index.html">F5 Web Application Firewall Solutions</a>
              &gt; <a href="../../waf102.html">WAF 102 - Getting started with WAF, Bot Detection and Threat Campaigns</a>
              &gt; <a href="../module3.html">Module 3: Threat Campaigns</a>

          <span class="right">
             <a href="../../../_sources/waf102/module3-tc/lab1/lab1.rst.txt" rel="nofollow">Source</a> |
             <a href="https://github.com/f5devcentral/f5-agility-labs-waf">Edit on <i class="fa fa-github" aria-hidden="true"></i></a>
          </span>
        </h5>
        <!-- end custom breadcrumb -->
      


    <!--a title="Export PDF" id="export-pdf" class="btn btn btn-link pull-right">View PDF</a-->
    <button type="button" id="export-pdf" class="btn btn-link right">PDF</button>


    
     
         <div class="sidebar" id="version-warning" style="display: none;">
           <p class="first sidebar-title">
           <span class="icon fa fa-info-circle fa-lg"></span> Version notice:</p>
           <p class="last" id="currentVersion"></p>
          </div>


     <div role="main">
        
  <div class="section" id="exercise-3-1-threat-campaigns">
<h1>Exercise 3.1: Threat Campaigns<a class="headerlink" href="#exercise-3-1-threat-campaigns" title="Permalink to this heading">¶</a></h1>
<p>Threat Campaign signatures are subscription based and sourced from a variety of threat intel sources based on real world campaigns to attack and/or take over resources.
Attackers are constantly looking for ways to exploit the latest vulnerabilities and/or new ways to exploit old vulnerabilities. F5’s Threat Research team is constantly monitoring malicious activity around the globe and creating signatures specific to these exploits. These Threat Campaign signatures are based on current “in-the-wild” attacks. Threat Campaign signatures contain contextual information about the nature and purpose of the attack.</p>
<p>As an example, a normal WAF signature might tell you that SQL injection was attempted. A Threat Campaign signature will tell you that a known threat actor used a specific exploit of the latest Apache Struts vulnerability (CVE -xxxx) in an attempt to deploy ransomware for cryptomining software.</p>
<div class="section" id="objective">
<h2>Objective<a class="headerlink" href="#objective" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li>Prep the Virtual Server</li>
<li>Review TC Signatures</li>
<li>Review Learning/Blocking settings and Staging Concept</li>
<li>Launch Attack</li>
<li>Test and verify logs</li>
<li>Estimated time for completion: <strong>20</strong> <strong>minutes</strong></li>
</ul>
</div>
<div class="section" id="prep-the-virtual-server">
<h2>Prep the Virtual Server<a class="headerlink" href="#prep-the-virtual-server" title="Permalink to this heading">¶</a></h2>
<p>These steps are necessary for this demonstration. In the “real world” having the Bot Defense Profile pick up this type of attack coming from a tool, not a browser, would be preferred, going back to the layered security approach.</p>
<ol class="arabic simple">
<li>Navigate to <strong>Local Traffic &gt; Virtual Servers &gt; Virtual Server List &gt; owasp-juiceshop_443_vs &gt; Security &gt; Policies</strong>.</li>
<li><strong>Enable the Application Security Policy: juiceshop_waf</strong>. Threat Campaign Signatures are part of your WAF policy.</li>
<li><strong>Disable the Bot Defense Profile</strong> We are removing the bot profile since we will be using a “Bot” to test the Threat Campaign signatures.</li>
<li><strong>Remove the Bot_Log profile</strong> and click <strong>Update</strong>. Your virtual should look like this:</li>
</ol>
<a class="reference internal image-reference" href="../../../_images/virtual.png"><img alt="../../../_images/virtual.png" src="../../../_images/virtual.png" style="width: 600px;" /></a>
</div>
<div class="section" id="review-tc-signatures">
<h2>Review TC Signatures<a class="headerlink" href="#review-tc-signatures" title="Permalink to this heading">¶</a></h2>
<ol class="arabic simple">
<li>Navigate to <strong>System &gt; Software Management &gt; Live Update &gt; Threat Campaigns</strong>. DO NOT update the system but note the Installation History. You can also view the Bot Signatures and other signature packages that are currently installed or pending.</li>
</ol>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Without an Advanced WAF license and Threat Campaign Subscription you will NOT get Live Updates for Bot Signatures.</p>
</div>
<ol class="arabic simple" start="2">
<li>Navigate to <strong>Security &gt; Options &gt; Application Security &gt; Threat Campaigns</strong> and review some of the signatures and information about them.</li>
<li>Click on the <strong>Apache Struts2 Jakarta Multipart Parser -gbk BillGates</strong> signature and note the attack type as well as the CVE reference: <strong>CVE-2017-5638</strong>. You can click the CVE reference link for more information.</li>
<li>Click on the filter button and under the Reference field, type: <strong>2020</strong> and <strong>Apply Filter</strong> to search for all CVE’s related to 2020.</li>
</ol>
<a class="reference internal image-reference" href="../../../_images/tc_sig.png"><img alt="../../../_images/tc_sig.png" src="../../../_images/tc_sig.png" style="width: 600px;" /></a>
</div>
<div class="section" id="review-tc-learning-and-blocking-settings">
<h2>Review TC Learning and Blocking Settings<a class="headerlink" href="#review-tc-learning-and-blocking-settings" title="Permalink to this heading">¶</a></h2>
<ol class="arabic simple">
<li>Navigate to <strong>Security &gt; Application Security &gt; Policy Building &gt; Learning and Blocking Settings</strong> and expand the <strong>Threat Campaigns</strong> section.</li>
<li>Note that the system is set to <strong>Alarm</strong> and <strong>Block</strong> on signature matches. Remember, our policy is in transparent mode so the blocking setting will not have any effect.</li>
</ol>
<a class="reference internal image-reference" href="../../../_images/tc.png"><img alt="../../../_images/tc.png" src="../../../_images/tc.png" style="width: 600px;" /></a>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Staging and the Enforcement Readiness period means that when new signatures are downloaded, if staging is enabled, the system will wait until the enforement readiness period is over before it starts blocking. You will still see alarms during this period. Due to the high accuracy nature of Threat Campaign signatures, the default system configuration is to have Staging turned off so new signatures go into effect immediately.</p>
</div>
</div>
<div class="section" id="test-tc-signatures-and-review-logs">
<h2>Test TC Signatures and Review Logs<a class="headerlink" href="#test-tc-signatures-and-review-logs" title="Permalink to this heading">¶</a></h2>
<div class="admonition important">
<p class="first admonition-title">Important</p>
<p class="last">Please ensure the ipi_tester script is not running in the terminal on the Linux Client. If it is, you can strop it with <strong>Ctrl+C</strong></p>
</div>
<ol class="arabic simple">
<li>From the Linux Client, confirm that the ipi_tester script is not running in the terminal and launch <strong>Postman</strong> from the Desktop. <strong>It takes a few moments for Postman to launch</strong>.</li>
</ol>
<img alt="../../../_images/postman.png" src="../../../_images/postman.png" />
<ol class="arabic simple" start="2">
<li>You will see a collection called <strong>Threat Campaigns</strong> and within, an item called <strong>test_req</strong>. This simply tests that the site is responding.</li>
<li>Click on <strong>test_req</strong> and then click the blue <strong>Send</strong> button on the top right. If your output does not look like this, please let a lab instructor know.</li>
</ol>
<a class="reference internal image-reference" href="../../../_images/test_req.png"><img alt="../../../_images/test_req.png" src="../../../_images/test_req.png" style="width: 600px;" /></a>
<ol class="arabic simple" start="4">
<li>Click on the <strong>Fortinet SSL VPN</strong> attack and then click the blue <strong>Send</strong> button. Repeat this process for the <strong>Oracle2</strong> attack. Explore the http headers and bodies being sent. If your policy was in blocking mode you would receive a block page but since the policy is transparent, these attacks are making it through and the juiceshop page is returned.</li>
<li>Back in Advanced WAF, navigate to <strong>Security &gt; Event Logs &gt; Application &gt; Requests</strong> and review the Sev5 events.</li>
</ol>
<a class="reference internal image-reference" href="../../../_images/events1.png"><img alt="../../../_images/events1.png" src="../../../_images/events1.png" style="width: 200px;" /></a>
<ol class="arabic simple" start="6">
<li>Click on the event for <strong>/remotefgt_lang</strong> and note the triggered violations. Click on <strong>All Details</strong> to the right of the screen to get more information. You can also click the <strong>Open to new tab</strong> icon in the top right to get an isolated view of this violation.</li>
</ol>
<a class="reference internal image-reference" href="../../../_images/newtab.png"><img alt="../../../_images/newtab.png" src="../../../_images/newtab.png" style="width: 200px;" /></a>
<ol class="arabic simple" start="7">
<li>When working in the WAF Requests event viewer, you can see exactly which Attack Signatures or Threat Campaigns were triggered under the <strong>Violations</strong> section. Click the <strong>Numerical Value</strong> under <strong>Occurrences</strong> for <strong>Threat Campaign detected</strong>.</li>
</ol>
<a class="reference internal image-reference" href="../../../_images/numerical.png"><img alt="../../../_images/numerical.png" src="../../../_images/numerical.png" style="width: 600px;" /></a>
<ol class="arabic simple" start="8">
<li>Notice that the there were actually 2 Threat Campaigns Signatures that triggered and you can see the Applied Blocking Setting of <strong>Alarm</strong></li>
<li>Click the little blue info icon next to one of the Threat Campaign Signatures for more information.</li>
</ol>
<a class="reference internal image-reference" href="../../../_images/info.png"><img alt="../../../_images/info.png" src="../../../_images/info.png" style="width: 600px;" /></a>
<ol class="arabic simple" start="10">
<li>Review the other alert that we generated from Postman and explore any additional Attack Signatures that were fired. In this instance, a Malformed XML Data signature that was enabled as part of our Rapid Deployment Policy also picked up the attack.</li>
</ol>
<a class="reference internal image-reference" href="../../../_images/other_alert.png"><img alt="../../../_images/other_alert.png" src="../../../_images/other_alert.png" style="width: 600px;" /></a>
<ol class="arabic simple" start="11">
<li>Navigate to <strong>Security &gt; Event Logs &gt; Application &gt; Event Correlation</strong> and explore the Dashboard.</li>
<li>Click on the <strong>Threat Campaign</strong> incident and then click on <strong>Export Incident</strong> and review the generated report.</li>
</ol>
<a class="reference internal image-reference" href="../../../_images/eventc.png"><img alt="../../../_images/eventc.png" src="../../../_images/eventc.png" style="width: 600px;" /></a>
<p><strong>This completes Lab 3</strong></p>
<p><strong>Congratulations! You just completed Lab 3 and have continued your introductory knowledge to Advanced WAF with Threat Campaign Signatures. These powerful and highly-accurate signatures are a great first step into enforcing blocking as they produce virtually no false positives.</strong></p>
</div>
</div>


     </div>
    
     <div class="row next-prev-btn-row">
       <div class="col-lg-12">
       
        <a href="../module3.html" title="Module 3: Threat Campaigns" accesskey="p" class="btn btn-primary left"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous</a>
       
       
          <a href="../../module4-xparent-policy/module4.html" title="Module 4: Transparent WAF Policy" accesskey="n" class="btn btn-primary right">Next <i class="fa fa-arrow-circle-right" aria-hidden="true"></i></a>
       
     </div>
     </div>
    

    </article>
  </div>

</div>


  <div id="clouddocs-footer"></div>
  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->

  <script src="../../../_static/js/index.js"></script>
  <script src="../../../_static/js/jquery.appear.js"></script>
  <script src="../../../_static/js/printThis.js"></script>
  <script src="../../../_static/js/bootstrap.min.js"></script>
  <script src="../../../_static/js/clouddocs.js"></script>
  <script src="../../../_static/js/CoveoJsSearch.Lazy.min.js"></script>
  </body>
</html>